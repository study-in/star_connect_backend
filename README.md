# star_connect_backend

A Node.js backend with JWT authentication, built with TypeScript, Express, and MongoDB, following a modular monolithic architecture. Includes LiveKit integration and SSLCommerz payment handling placeholders.

## Features

* **Modular Architecture:** Code organized by feature modules (Auth, User, Expert, Booking, Payment, etc.).
* **TypeScript:** Strongly typed codebase.
* **Authentication:** JWT-based login/registration (Bearer Token). Role-based access control middleware included.
* **Database:** MongoDB with Mongoose ODM. Models based on Star Connect requirements.
* **LiveKit Integration:** Service and controller for generating LiveKit client tokens.
* **Payment Integration:** Placeholders for SSLCommerz payment initiation and IPN handling.
* **Error Handling:** Centralized global error handler and custom \`AppError\` class.
* **Validation:** Placeholder structure for input validation using Zod within modules.
* **Logging:** Winston setup for file and console logging (environment-aware).
* **API Documentation:** Swagger (OpenAPI) setup for interactive API docs at `/api-docs`.
* **Security:** Basic security with Helmet, CORS configuration, rate limiting.
* **Development:** Configured with ESLint, Prettier, and `ts-node-dev` for hot-reloading.
* **Deployment:** Includes `Dockerfile`, `docker-compose.yml`, `vercel.json`, and a basic GitHub Actions CI workflow (`.github/workflows/node.yml`).
* **Server Monitoring:** Basic monitor page at the root (`/`) showing system info, usage, and log links.
* **View Engine:** EJS setup for potential server-rendered pages (e.g., error page, basic home).

## Project Structure

```
.
├── cert/                 # SSL certificates (optional)
├── dist/                 # Compiled JavaScript output
├── logs/                 # Application logs (Winston)
├── public/               # Static assets (CSS, JS, images)
├── src/
│   ├── app/
│   │   ├── middlewares/  # Express middleware (auth, error, validation, logger)
│   │   ├── modules/      # Feature modules (Auth, User, Booking, etc.)
│   │   │   └── ExampleModule/
│   │   │       ├── example.controller.ts
│   │   │       ├── example.interface.ts
│   │   │       ├── example.model.ts
│   │   │       ├── example.route.ts
│   │   │       ├── example.service.ts
│   │   │       └── example.validation.ts
│   │   └── routes/       # Main API router (index.ts aggregates module routes)
│   ├── config/           # Environment configuration loader (index.ts)
│   ├── constants/        # Application constants (pagination, roles)
│   ├── errors/           # Custom error handling utilities
│   ├── helpers/          # Helper functions (jwt, pagination, email, logs)
│   ├── html/             # HTML templates (e.g., for emails)
│   ├── interfaces/       # Shared TypeScript interfaces/types (common, error, index.d.ts)
│   ├── shared/           # Shared utilities (catchAsync, logger, pick, sendResponse)
│   ├── utils/            # General utilities (AppError, fileUtils, serverMonitor, swagger)
│   ├── app.ts            # Express application setup
│   └── server.ts         # Server entry point (connects DB, starts server)
├── views/                # EJS templates
├── .env                  # Environment variables (GITIGNORED!)
├── .eslintrc.js          # ESLint configuration
├── .gitignore            # Git ignore rules
├── .prettierrc           # Prettier configuration
├── Dockerfile            # Docker build instructions
├── docker-compose.yml    # Docker Compose setup (includes optional MongoDB)
├── package.json          # Project dependencies and scripts
├── tsconfig.json         # TypeScript compiler options
└── vercel.json           # Vercel deployment configuration
```

## Getting Started

1.  **Clone:** `git clone <repository-url>`
2.  **Install Dependencies:** `npm install`
3.  **Environment Variables:**
    * Copy `.env.example` (if provided) or create `.env` based on the example in `createStructure_modular.js` or the one generated by it.
    * Fill in **all required** variables (MONGODB_URI, JWT_SECRET, JWT_REFRESH_SECRET, LIVEKIT_API_KEY, LIVEKIT_API_SECRET, SSLCOMMERZ_STORE_ID, SSLCOMMERZ_STORE_PASSWORD, etc.).
4.  **Development:** `npm run dev` (Uses `ts-node-dev` for auto-reloading)
5.  **Build:** `npm run build` (Compiles TypeScript to `./dist`)
6.  **Production:** `npm start` (Runs the compiled code from `./dist`)
7.  **HTTPS (Optional):** Place `server.cert` and `server.key` in the `cert/` directory and set `HTTPS=true` in your `.env` file.
8.  **Docker:** Use `docker-compose up --build` to build and run the app and a MongoDB container.

## API Documentation

Once the server is running, access the Swagger UI documentation at [http://localhost:PORT/api-docs](http://localhost:PORT/api-docs) (replace PORT with the actual port number).
